<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Importing iptables configurations into Firewall Builder</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<style type="text/css">
<!--
.command {
    padding: 1em;
    border: 1px dashed #2f6fab;
    color: black;
    background-color: #f9f9f9;
    line-height: 1.1em;
        font-family: Courier New, Courier, mono;
        font-size: 12px;
        font-style: italic;
}

.system {
    color: black;
        font-family: Courier New, Courier, mono;
        font-size: 12px;
        font-style: italic;
}

.highlight {
    color: #FF0000;
  font-family: Georgia, "Times New Roman", Times, serif;
  font-size: 12px;
  text-decoration: underline;
}
-->
</style>
</head>
  <body>

    <h1>Importing iptables configurations into Firewall Builder</h1>
    <img src="fwbuilder_logo.png" />
    <p>
    Author: Mike Horn &#60;mike [at] netcitadel [dot] com&#62;<br/>
    <a href="http://www.fwbuilder.com/?utm_source=web&utm_medium=howtoforge&utm_campaign=iptables_import">
    http://www.fwbuilder.org</a>
    </p>

    <p>
    Firewall Builder is a firewall configuration and management GUI 
    that supports configuring a wide range of firewalls from a 
    single application. Supported firewalls include Linux iptables, 
    BSD pf, Cisco ASA/PIX, Cisco router access lists and many
    more. The complete list of supported platforms along with
    downloadable binary packages and soure code can be found at 
    <a href="http://www.fwbuilder.com/?utm_source=web&utm_medium=howtoforge&utm_campaign=howto_cisco_router_acl">
    http://www.fwbuilder.org</a>.
    </p>

    <p>
    Import of existing iptables configurations was greatly improved 
    in the recently released Firewall Builder V4.2. Features like 
    object de-duplication and expanded rules recognition make it 
    even easier to get started using Firewall Builder to manage 
    your iptables configurations.
    </p> 

    <p>
    For this tutorial we are going to import a very basic iptables 
    configuration from a firewall that matches the diagram shown 
    below.
    </p> 

    <img src="iptables_import_diagram.png" />

    <p>
      Firewall Builder imports iptables configs in the format of 
      iptables-save. Script <b>iptables-save</b> is part
      of the standard iptables install and should be
      present on all Linux distribution. Usually this
      script is installed in <b>/sbin/</b>. 
    </p>
      
    <p>
      When you run this script, it dumps the current iptables 
      configuration to stdout. It reads iptables rules directly form 
      the kernel rather than from some file, so what it dumps is what 
      is really working right now. To import this into Firewall Builder, 
      run the script to save the configuration to a file:
    </p>

    <p class="command">
    iptables-save &gt; linux-1.conf
    </p>

    <p>
      As you can see in the output below, the example linux-1.conf iptables 
      configuration is very simple with only a few filter rules and one 
      nat rule.
    </p>
          
    <p class="command">
    # Completed on Mon Apr 11 21:23:33 2011<br />
    # Generated by iptables-save v1.4.4 on Mon Apr 11 21:23:33 2011<br />
    *filter<br />
    :INPUT DROP [145:17050]<br />
    :FORWARD DROP [0:0]<br />
    :OUTPUT DROP [1724:72408]<br />
    :LOGDROP - [0:0]<br />
    -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT<br />
    -A INPUT -i eth1 -s 10.10.10.0/24 -d 10.10.10.1/32 -p tcp -m tcp --dport 22 -m state --state NEW -j ACCEPT<br />
    -A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT<br />
    -A FORWARD -o eth0 -s 10.10.10.0/24 -p tcp -m tcp --dport 80 -m state --state NEW -j ACCEPT<br />
    -A FORWARD -o eth0 -s 10.10.10.0/24 -p tcp -m tcp --dport 443 -m state --state NEW -j ACCEPT<br />
    -A FORWARD -j LOGDROP<br />
    -A LOGDROP -j LOG<br />
    -A LOGDROP -j DROP<br />
    COMMIT<br />
    # Completed on Mon Apr 11 21:23:33 2011<br />
    # Generated by iptables-save v1.4.4 on Mon Apr 11 21:23:33 2011<br />
    *nat<br />
    :PREROUTING ACCEPT [165114:22904965]<br />
    :OUTPUT ACCEPT [20:1160]<br />
    :POSTROUTING ACCEPT [20:1160]<br />
    -A POSTROUTING -s 10.10.10.0/24 -o eth0 -j MASQUERADE<br />
    COMMIT<br />
    # Completed on Mon Apr 11 21:23:33 2011<br />
    </p> 

    <p>
    If you are running Firewall Builder on a different system than the 
    one that is running iptables copy the file <b>linux-1.conf</b> 
    from the firewall to the system where Firewall Builder is running.
    </p>

    <p>
    Launch the Import wizard by selecting the File -&gt; Import Firewall menu 
    item.
    </p>

    <p>
    Click <b>Browse</b> to find the file named linux-1.conf. 
    </p>

    <img src="iptables_import_select_file.png" />
    
    <p>
    Click the <b>Continue</b> button to move to the next step of the import 
    process.
    </p>

</body>
</html>
