<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Firewall Builder: Using Firewall Object | HowtoForge - Linux Howtos and Tutorials</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<style type="text/css">
<!--
.command {
    padding: 1em;
    border: 1px dashed #2f6fab;
    color: black;
    background-color: #f9f9f9;
    line-height: 1.1em;
        font-family: Courier New, Courier, mono;
        font-size: 12px;
        font-style: italic;
}

.system {
    color: black;
        font-family: Courier New, Courier, mono;
        font-size: 12px;
        font-style: italic;
}

.highlight {
    color: #FF0000;
        font-family: Georgia, "Times New Roman", Times, serif;
        font-size: 12px;
        text-decoration: underline;
}
-->
</style>
</head>

<body>

  <h1>Network, Address Range Objects and Groups of Address Objects</h1>

  <h2>IPv4 Network Object</h2>

  <p></p>

  <img src="network_dialog1.png"/>

  <p>
    The network object describes an IP network or
    subnet. Use main menu <b>"Net Object / New Network"</b>
    item to create objects of this type. The dialog of
    the Network obejct provides the following entry
    fields:
  </p>

  <p>
    <ul>
      <li>Name -- Network object name 
      </li>

      <li>Address -- This is the IPv4 address of the
        network
      </li>

      <li>Netmask -- The netmask, in combination with an
        Address, deflnes the subnet. You can enter either
        string octet representation of the mask or its bit
        length here, however the program always converts
        it to the octet representation. Netmask in the
        network object is always entered in the "natural"
        way, such as "255.255.255.0", even if the object
        is going to be used to build Cisco IOS access
        lists which require reversed "bit mask"
        presentation instead (e.g "0.0.0.255" for the
        netmask above). Firewall Builder policy compiler
        takes care of the conversion automatically.
      </li>

      <li>Comment -- This is a free-form text field used
        for comments
      </li>
    </ul>
  </p>

  <p>
    Lets try to use Network object shown on the
    screenshot above in a policy rule of firewalls
    compiled for different target platforms.
  </p>

  <img src="network_example_1.png"/>

  <p>
    Here is what we get for iptables:

    <p class="command">
      $IPTABLES -A FORWARD -p tcp -m tcp  -s 172.16.22.0/24  --dport 80  -m state --state NEW  -j ACCEPT 
    </p>
  </p>

  <p>
    Here is the output produced for PF:

    <p class="command">
      pass in   quick inet proto tcp  from 172.16.22.0/24  to any port 80 keep state<br>
      pass out  quick inet proto tcp  from 172.16.22.0/24  to any port 80 keep state<br>
    </p>
  </p>

  <p>
    Here is how the output looks like when the rule is
    compiled into Cisco IOS access-lists (this is one of the
    generated access lists):

    <p class="command">
      ip access-list extended outside_out<br>
      permit tcp 172.16.22.0 0.0.0.255 any  eq 80 <br>
      exit<br>
    </p>
  </p>


  <p>
    Here is what we get when the rule is compiled into
    Cisco ASA (PIX) configuration. Note how compiler
    uses netmask 255.255.255.0 for PIX, while for IOS it
    was converted to 0.0.0.255. Also,
    interface <b>inside</b> was confgured with network
    zone <b>172.16.0.0/12</b> which matched network
    object used in the source element of the rule,
    because of that compiler put the rule only into
    access list attached to interface <b>inside</b>.

    <p class="command">
      access-list inside_acl_in permit tcp 172.16.22.0 255.255.255.0 any eq 80 <br>
      access-group inside_acl_in in interface inside<br>
    </p>
  </p>


  <h2>IPv6 Network Object</h2>

  <p></p>

  <img src="ipv6-network_dialog1.png"/>

  <p>
    The network object describes an IPv6 network or
    subnet. This object is very similar to the IPv4
    Network object, except you can only enter netmask as
    a bit length.  Use main menu <b>"Net Object / New
      Network IPv6"</b> item to create objects of this
    type.
  </p>

  <p>
    Lets see what we get if we use IPv6 Network object
    in a policy rule like shown in the screenshot:
  </p>

  <img src="ipv6_network_example_1.png"/>

  <p>
    Here is the command generated for iptables:

    <p class="command">
      $IP6TABLES -A FORWARD -p tcp -m tcp  -s 2001:470:1f0e:162::/64  --dport 80  -m state --state NEW  -j ACCEPT 
    </p>
  </p>

  <p>
    Here is what we get for PF:

    <p class="command">
      pass in   quick inet6 proto tcp  from 2001:470:1f0e:162::/64  to any port 80 keep state<br>
      pass out  quick inet6 proto tcp  from 2001:470:1f0e:162::/64  to any port 80 keep state<br>
    </p>
  </p>

  <p>
    Here is the output for Cisco IOS access lists (only
    one ACL is shown):

    <p class="command">
      ipv6 access-list ipv6_outside_out<br>
      permit tcp 2001:470:1f0e:162::/64 any  eq 80 <br>
      exit<br>
<br>
      interface eth0<br>
      ipv6 traffic-filter ipv6_outside_out out<br>
      exit<br>
    </p>
  </p>

  <p>
    There is no IPv6 support for Cisco ASA (PIX) in
    fwbuilder at this time.
  </p>

  <h2>Address Range Object</h2>
  
  <p></p>

  <img src="address_range_1.png"/>

  <p>
    The Address Range object describes a continuous range
    of IPv4 addresses. (Arbitrary address ranges are
    unsupported for IPv6.) To create new Address Range
    object, use main menu <b>"New Object / New Address
      Range"</b>. Its dialog provides the following entry
    fields:
  </p>

  <p>
    <ul>
      <li>Name -- The name of the Address Range object 
      </li>

      <li>Range start -- The address of the start of the range 
      </li>

      <li>Range end -- The address of the end of the range 
      </li>

      <li>Comment -- A free-form text field used for comments 
      </li>
    </ul>
  </p>

  <p>
    The Address range is inclusive, that is, both the
    start and the end addresses are included in the range.
  </p>

  <p>
    When Address Range object is used in a rule, Firewall
    Builder replaces it with a list of addresses
    equivalent to the specified range. The program tries
    to generate most economical representation of the
    range using combiantion of subnets of different
    length. Consider Address Range object as shown on the
    screenshot above. This Address Range object represents
    IP addresses between <b>192.168.1.100</b>
    and <b>192.168.1.160</b> (inclusively). It would be
    wasteful to generate 61 iptables commands to represent
    this range. Instead, compiler uses combination of
    several subnets of different length and ends up with
    the following:
  </p>

  <p>
    <p class="command">
      $IPTABLES -A FORWARD  -s 192.168.1.100/30  -m state --state NEW  -j ACCEPT <br>
      $IPTABLES -A FORWARD  -s 192.168.1.104/29  -m state --state NEW  -j ACCEPT <br>
      $IPTABLES -A FORWARD  -s 192.168.1.112/28  -m state --state NEW  -j ACCEPT <br>
      $IPTABLES -A FORWARD  -s 192.168.1.128/27  -m state --state NEW  -j ACCEPT <br>
      $IPTABLES -A FORWARD  -s 192.168.1.160  -m state --state NEW  -j ACCEPT <br>
    </p>
  </p>

  <p>
    Here is how generated configuration looks like for PF
    (this is essentially the same except it uses tables
    for brevity):
  </p>

  <p>
    <p class="command">
      table &lt;tbl.r0.s&gt; { 192.168.1.100/30 , 192.168.1.104/29 , 192.168.1.112/28 , 192.168.1.128/27 , 192.168.1.160 } <br>
<br>
      pass in   quick inet  from &lt;tbl.r0.s&gt;  to any keep state<br>
    </p>
  </p>

  <p>
    Just for completness, lets look at the configuration
    generated for the same rule for Cisco IOS access lists.
    This is really jsut a fragment of the generate router
    access list configuration because geenrated ACLs are
    attached to interfaces and, since the rule in the
    example was not associated with any interface, it got
    attached to all of them. Here we show only one generated
    ACL:
  </p>
  
  <p>
    <p class="command">
<br>
      ip access-list extended inside_in<br>
      ! <br>
      ! Rule  0 (global)<br>
      ! <br>
      ! <br>
      permit ip 192.168.1.100 0.0.0.3 any  <br>
      permit ip 192.168.1.104 0.0.0.7 any  <br>
      permit ip 192.168.1.112 0.0.0.15 any  <br>
      permit ip 192.168.1.128 0.0.0.31 any  <br>
      permit ip host 192.168.1.160 any  <br>
      exit<br>
    </p>
  </p>

  <h2>A Group Of Addressable Objects</h2>

  <p></p>

  <img src="group-view1.png"/>

  <p>
    The group of objects holds references to Hosts,
    Networks, Address Ranges, Firewalls and other groups
    of addressable objects. Use main menu <b>"New Obejct /
      New Obejct Group"</b> to create new obejct of this
    type. Objects can be added to the group using the
    following methods:
  </p>

  <p>
    <ul>
      <li>Using drag and drop -- Objects can be dragged
        from the tree into the group dialog. The tree
        switches to the object in a single click, however
        pointing a mouse cursor at the object and then
        pressing the button does not switch, but rather
        allows to start a drag and drop operation.
      </li>

      <li>Using the popup menu -- You can use the
        Copy/Paste operations between the tree and group
        dialog. Right mouse clicking on the object in the
        tree brings a pop-up menu. Choose Copy or Cut in
        this menu, then switch to the group dialog and
        right mouse click in the icon field. This also
        brings up a pop-up menu, where you choose
        Paste. This inserts a reference to the object in
        the group.
      </li>

      <li>Using the Edit main menu -- Just like in the
        case of a pop-up menu, select the object in the
        tree, use the Edit/Copy Object, then switch to the
        group dialog and use the Edit/Paste Object main
        menu.
      </li>
    </ul>
  </p>


</body>
</html>
