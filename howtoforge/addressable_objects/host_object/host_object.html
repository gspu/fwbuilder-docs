<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Firewall Builder: Using Firewall Object | HowtoForge - Linux Howtos and Tutorials</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<style type="text/css">
<!--
.command {
    padding: 1em;
    border: 1px dashed #2f6fab;
    color: black;
    background-color: #f9f9f9;
    line-height: 1.1em;
        font-family: Courier New, Courier, mono;
        font-size: 12px;
        font-style: italic;
}

.system {
    color: black;
        font-family: Courier New, Courier, mono;
        font-size: 12px;
        font-style: italic;
}

.highlight {
    color: #FF0000;
        font-family: Georgia, "Times New Roman", Times, serif;
        font-size: 12px;
        text-decoration: underline;
}
-->
</style>
</head>

<body>

  <h2>The Host Object</h2>

  <p>
    The host object in Firewall Builder is designed to
    represent real hosts in the network: workstations,
    servers, and any other network node with an
    address. Just like real hosts, the host objects have
    interfaces, representing different physical
    connections to the network. Most Internet hosts will
    have just a single (visible) interface with a single
    IP address. In that case the actual interface and
    its name do not matter.  For most foreign hosts,
    Firewall Builder will assign an arbitrary name
    “interface1” to the hosts interface.  By using a
    tree-like hierarchy of hosts -> interfaces ->
    addresses it is possible however to specify the
    exact address and/or interface of a host in the case
    when it does matter. Both interfaces and addresses
    are represented by objects, which are organized in a
    tree. Interface objects sit in the tree directly
    under the host, and the address objects are located
    under their interfaces. The interface object can
    have either one or multiple addresses. An example of
    a host with one interface with multiple addresses
    are shown in the screenshot below. Host <b>“test
      server”</b> has three virtual IP addresses that all
    belong to the same interface <b>“eth0”</b>.
  </p>


  <blockquote>
    Note that in Firewall Builder, the host object is an
    abstraction. It does not have to conform to an
    individual host. This host object may in fact
    represent a web farm that accepts connections on
    three IP addresses, each on a different computer.
  </blockquote>

  <img src="host_in_tree.png"/>

  <blockquote>
    Note: The host object cannot have any access, NAT or
    routing policy associated with it; only firewall
    objects can have policies.
  </blockquote>

  <h2>Creating Host Object</h2>

  <p></p>

  <img src="creating_host1.png"/>

  <p>
    To speed up the process and make it simpler,
    creating a new host object is aided by the wizard
    which collects all data needed for both the host and
    its interfaces and then creates the object. The
    screenshot above represents the first page of the
    wizard.
  </p>

  <p>
    Enter the host name. Generally, this name does not
    have to be the same as the real host’s
    name. However, if you are going to use SNMP to
    populate the host’s interfaces, or if you are going
    to use DNS to look up interface IP addresses, the
    name does have to match.
  </p>

  <p>
    You can create a new host from a template by
    checking corresponding checkbox on the first page of
    the wizard, or you can do it manually. Lets look at
    the manual process. To do this, click "Next" button
    to switch to the page where you can enter interfates
    and their addresses.
  </p>
  
  <img src="creating_host2.png"/>

  <p>
    If the new host object has a single interface (this,
    perhaps, is the most common case) then you just need
    to fill the entry field for its address and maybe MAC
    address and click Next. If the object’s name is the
    same as the real host name, then you can use the DNS
    Lookup button to get the address from DNS.
  </p>

  <p>
    Here you can add interfaces to the new host
    object. Enter the interface name, address, and
    netmask in the appropriate fields, then
    click <b>"Add"</b> to add it to the list. (If the
    interface is dynamic or unnumbered, then click the
    appropriate checkbox instead of entering address
    information.) The <b>"Update"</b> button updates
    information for the interface that is selected in
    the list, and the <b>"Delete"</b> button deletes the
    currently selected interface.
  </p>

  <p>
    This method only works for IPv4 addresses. If you
    need to add an IPv6 address, save the host object
    without the IPv6 address, then add the IPv6 address
    to the interface.
  </p>

  <blockquote>
    Note: You can always add, modify and remove
    interfaces of the new host object later using
    controls provided by the main window and the object
    tree view.
  </blockquote>

  <h3>Editing a Host Object</h3>

  <p></p>

  <img src="host_dialog1.png"/>

  <p>
    The Host object dialog allows you to edit the
    following parameters:
  </p>

  <p>
    <ul>
      <li>
        Name -- The Host object name. 
      </li>

      <li>
        MAC matching -- If this option is activated, the
        policy compiler uses the MAC addresses of all
        interfaces of this host in the ﬁrewall
        rules. Not all ﬁrewall platforms support MAC
        address ﬁltering, so this option may have no
        effect on the generated ﬁrewall script. This is
        treated as a non-critical situation, and the
        policy compiler will only generate a warning
        while processing a ﬁrewall policy where such a
        host is used.
      </li>

      <li>
        Comment -- This is a free-form text ﬁeld which
        can be used to add comments.
      </li>
    </ul>
  </p>


  <h3>Using Host Object in Rules</h3>

  <p>
    When Host object is used in a rule, it acts as a
    group of all of its addresses, that is, adresses
    that belong to all of its interfaces. The only
    exception is loopback interface; compilers skip its
    address when they replace Host object with its
    addresses.
  </p>

  <p>
    Consider the following Host object. It has
    interface <b>eth0</b> with two IP addresses and a
    MAC address, interface <b>he-ipv6</b> with IPv6
    address and a MAC address, interface <b>lo</b>
    (loopback) with its own IP address and
    interface <b>sit0</b> (tunnel) with no address.
  </p>

  <img src="host_example_1.png"/>

  <p>
    Lets put this host object in a rule as follows:
  </p>

  <img src="host_example_2.png"/>

  <p>
    The rule set is configured as "IPv4 only", so even
    though interface <b>he-ipv6</b> has IPv6 address,
    fwbuilder will ignore it while generating iptables
    commands for this rule. Interface <b>eth0</b> has two
    IPv4 addresses and both will be used. Here are iptables
    commands generated for this rule:
  </p>

  <p>
    <p class="command">
      $IPTABLES -A FORWARD -p tcp -m tcp  --dport 22  -m state --state NEW  -j Cid6066X5981.1 <br>
      $IPTABLES -A Cid6066X5981.1  -d 10.3.14.44  -j ACCEPT <br>
      $IPTABLES -A Cid6066X5981.1  -d 10.3.14.55  -j ACCEPT <br>
      $IPTABLES -A Cid6066X5981.1  -d  -j ACCEPT <br>
    </p>
  </p>

  <p>
    Lets see what we get for the same rule if we configure
    rule set object as "IPv4+IPv6":
  </p>

  <img src="host_example_3.png"/>

  <p>
    Since rule is now configured to compile for both
    address families, fwbuilder processes it twice,
    using on each pass only those addresses of the host
    that match address family. Here is what we get
    (these are relevant fragments of the generated script):
  </p>

  <p>
    <p class="command">
      # ================ IPv4<br>
<br>
      $IPTABLES -A FORWARD -p tcp -m tcp  --dport 22  -m state --state NEW  -j Cid6066X5981.1 <br>
      $IPTABLES -A Cid6066X5981.1  -d 10.3.14.44  -j ACCEPT <br>
      $IPTABLES -A Cid6066X5981.1  -d 10.3.14.55  -j ACCEPT <br>
      $IPTABLES -A Cid6066X5981.1  -d  -j ACCEPT <br>
<br>
      # ================ IPv6<br>
<br>
      $IP6TABLES -A FORWARD -p tcp -m tcp  --dport 22  -m state --state NEW  -j Cid6066X5981.1 <br>
      $IP6TABLES -A Cid6066X5981.1  -d fe80::a3:e2c  -j ACCEPT <br>
    </p>
  </p>

</body>
</html>
